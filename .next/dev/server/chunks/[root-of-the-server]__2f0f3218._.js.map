{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/kirti.krishnan/Desktop/Projects/RTAA/rtaa/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\n\nif (!supabaseUrl) {\n  throw new Error('Missing NEXT_PUBLIC_SUPABASE_URL in environment');\n}\nif (!supabaseServiceRoleKey) {\n  throw new Error('Missing SUPABASE_SERVICE_ROLE_KEY in environment');\n}\n\n// Custom fetch with better error handling for Node.js and corporate proxies\nconst customFetch: typeof fetch = async (input, init) => {\n  try {\n    // For development: bypass SSL verification for corporate proxies\n    // In Node.js 20+, we need to handle self-signed certificates\n    const https = await import('https');\n    const agent = new https.Agent({\n      rejectUnauthorized: false, // Accept self-signed certificates\n    });\n\n    const response = await fetch(input, {\n      ...init,\n      // @ts-ignore - agent is valid for Node.js fetch\n      agent,\n      // @ts-ignore - keepalive may not be in types but is valid\n      keepalive: false,\n    });\n    return response;\n  } catch (error) {\n    console.error('Supabase fetch error:', error);\n    throw error;\n  }\n};\n\nexport const supabase = createClient(supabaseUrl, supabaseServiceRoleKey, {\n  auth: { persistSession: false },\n  global: {\n    headers: { 'x-rt-agent-assist': 'rtaa-demo' },\n    fetch: customFetch,\n  },\n});\n\n\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM,yBAAyB,QAAQ,GAAG,CAAC,yBAAyB;AAEpE;;AAGA,IAAI,CAAC,wBAAwB;IAC3B,MAAM,IAAI,MAAM;AAClB;AAEA,4EAA4E;AAC5E,MAAM,cAA4B,OAAO,OAAO;IAC9C,IAAI;QACF,iEAAiE;QACjE,6DAA6D;QAC7D,MAAM,QAAQ;QACd,MAAM,QAAQ,IAAI,MAAM,KAAK,CAAC;YAC5B,oBAAoB;QACtB;QAEA,MAAM,WAAW,MAAM,MAAM,OAAO;YAClC,GAAG,IAAI;YACP,gDAAgD;YAChD;YACA,0DAA0D;YAC1D,WAAW;QACb;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM;IACR;AACF;AAEO,MAAM,WAAW,IAAA,yMAAY,EAAC,aAAa,wBAAwB;IACxE,MAAM;QAAE,gBAAgB;IAAM;IAC9B,QAAQ;QACN,SAAS;YAAE,qBAAqB;QAAY;QAC5C,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///Users/kirti.krishnan/Desktop/Projects/RTAA/rtaa/app/api/kb/search/route.ts"],"sourcesContent":["// app/api/kb/search/route.ts\n\nimport { NextResponse } from 'next/server';\nimport { supabase } from '@/lib/supabase';\n\nexport async function GET(req: Request) {\n  try {\n    const url = new URL(req.url);\n    const q = (url.searchParams.get('query') || '').trim();\n\n    if (!q) {\n      // return top 3 articles if no query\n      const { data, error } = await supabase\n        .from('kb_articles')\n        .select('id,title,snippet,url,tags')\n        .limit(3);\n      if (error) throw error;\n      return NextResponse.json({ ok: true, results: data });\n    }\n\n    // simple ILIKE search across title and snippet\n    const { data, error } = await supabase\n      .from('kb_articles')\n      .select('id,title,snippet,url,tags')\n      .or(`title.ilike.%${q}%,snippet.ilike.%${q}%`)\n      .limit(3);\n\n    if (error) throw error;\n    return NextResponse.json({ ok: true, results: data });\n  } catch (err: any) {\n    console.error('kb search error', err?.message ?? err);\n    return NextResponse.json({ ok: false, error: err?.message ?? String(err) }, { status: 500 });\n  }\n}\n\n\n\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;AAE7B;AACA;;;AAEO,eAAe,IAAI,GAAY;IACpC,IAAI;QACF,MAAM,MAAM,IAAI,IAAI,IAAI,GAAG;QAC3B,MAAM,IAAI,CAAC,IAAI,YAAY,CAAC,GAAG,CAAC,YAAY,EAAE,EAAE,IAAI;QAEpD,IAAI,CAAC,GAAG;YACN,oCAAoC;YACpC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,6HAAQ,CACnC,IAAI,CAAC,eACL,MAAM,CAAC,6BACP,KAAK,CAAC;YACT,IAAI,OAAO,MAAM;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,IAAI;gBAAM,SAAS;YAAK;QACrD;QAEA,+CAA+C;QAC/C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,6HAAQ,CACnC,IAAI,CAAC,eACL,MAAM,CAAC,6BACP,EAAE,CAAC,CAAC,aAAa,EAAE,EAAE,iBAAiB,EAAE,EAAE,CAAC,CAAC,EAC5C,KAAK,CAAC;QAET,IAAI,OAAO,MAAM;QACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,SAAS;QAAK;IACrD,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,mBAAmB,KAAK,WAAW;QACjD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO,OAAO,KAAK,WAAW,OAAO;QAAK,GAAG;YAAE,QAAQ;QAAI;IAC5F;AACF","debugId":null}}]
}